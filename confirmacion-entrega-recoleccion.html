<!DOCTYPE html>
<html lang="es">
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contacto - EcoBox</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="stylesheet" href="assets/css/pages.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
</head>
<body>
<header>
<nav class="navbar">
    <div class="container navbar-content">
    <a href="index.html" class="logo">
    <img src="assets/img/Greenhaul-fl.svg" alt="Logo de GreenHaul">
</a>
        <button class="navbar-toggler" id="navbarToggler" aria-label="Toggle navigation">
            <span class="toggler-icon"></span>
            <span class="toggler-icon"></span>
            <span class="toggler-icon"></span>
        </button>
        <div class="navbar-collapse" id="navbarCollapse">
            <ul class="nav-links-list">
                <li><a href="index.html" class="nav-link active">Inicio</a></li>
                <li><a href="productos.html" class="nav-link">Productos</a></li>
                <li><a href="servicios.html" class="nav-link">Servicios</a></li>
                <li><a href="nosotros.html" class="nav-link">Nosotros</a></li>
                <li><a href="contacto.html" class="nav-link">Contacto</a></li>
                <li><a href="faq.html" class="nav-link">Preguntas</a></li>
            </ul>
            <div class="navbar-right-items">
            <div class="navbar-user-actions" id="navbarUserActions">
                    <a href="login.html" class="btn btn-outline" id="loginBtn">Iniciar Sesi√≥n</a>
                    <a href="cuenta.html" class="nav-link" id="accountLink" style="display: none;">Hola, <span id="userName"></span></a>
                    <button class="btn-tertiary" id="logoutBtn" style="display: none;" title="Cerrar Sesi√≥n"><i class="fas fa-sign-out-alt"></i></button>
                </div>
                <div class="nav-icons">
                    <a href="#" class="nav-icon cart-icon" id="cartIcon">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="cart-count" id="cartCount">0</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
</nav>
</header>

        <main class="page-content">
            <section class="section">
                <div class="container">
                    <div class="section-title">
                        <h2>Direcciones de tu Mudanza üó∫Ô∏è</h2>
                        <p>Confirma tus direcciones antes de proceder al pago.</p>
                    </div>
                    <div class="contact-grid">
                        <div class="contact-form-container">
                            <h3>Direcci√≥n de Entrega <span class="emoji">üè°</span></h3>
                            <p class="map-instruction">Arrastra el pin para ajustar la ubicaci√≥n.</p>
                            <form id="deliveryAddressForm">
                                <div class="form-group">
                                    <label for="deliveryAddress">Direcci√≥n Completa</label>
                                    <input type="text" id="deliveryAddress" class="form-control" placeholder="La direcci√≥n aparecer√° aqu√≠..." required>
                                </div>
                                <div class="map-container" id="deliveryMap"></div>
                                <button type="submit" class="btn btn-primary" style="width:100%;">Confirmar Direcci√≥n</button>
                            </form>
                        </div>
                        <div class="contact-form-container">
                            <h3>Direcci√≥n de Recolecci√≥n <span class="emoji">üöö</span></h3>
                            <p class="map-instruction">Arrastra el pin para ajustar la ubicaci√≥n.</p>
                            <form id="pickupAddressForm">
                                <div class="form-group">
                                    <label for="pickupAddress">Direcci√≥n Completa</label>
                                    <input type="text" id="pickupAddress" class="form-control" placeholder="La direcci√≥n aparecer√° aqu√≠..." required>
                                </div>
                                <div class="map-container" id="pickupMap"></div>
                                <button type="submit" class="btn btn-primary" style="width:100%;">Confirmar Direcci√≥n</button>
                            </form>
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 40px;">
                        <button class="btn btn-primary btn-big-cta" id="finalizeOrderBtn">Continuar al Pago</button>
                    </div>
                </div>
            </section>
        </main>
        
        <footer class="footer">
        <div class="container footer-content">
            <div class="footer-info">
                <h3>greenhauL</h3>
                <p>Mudanzas sostenibles, sin complicaciones.</p>
                <p><i class="fas fa-phone-alt"></i> +52 55 1234 5678</p>
                <p><i class="fas fa-envelope"></i> info@greenhauL.com</p>
                <p><i class="fas fa-map-marker-alt"></i> Ciudad de M√©xico</p>
            </div>
            <div class="footer-links">
                <h3>Enlaces R√°pidos</h3>
                <ul>
                    <li><a href="index.html">Inicio</a></li>
                    <li><a href="productos.html">Productos</a></li>
                    <li><a href="servicios.html">Servicios</a></li>
                    <li><a href="nosotros.html">Nosotros</a></li>
                    <li><a href="contacto.html">Contacto</a></li>
                </ul>
            </div>
            <div class="footer-social-links">
                <h3>S√≠guenos</h3>
                <div class="social-icons-wrapper">
                    <a href="#" class="social-icon" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="social-icon" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="#" class="social-icon" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            &copy; <span id="current-year">2025</span> greenhauL. Todos los derechos reservados.
        </div>
    </footer>
        
        <div class="cart-notification" id="cartNotification"><div class="notification-content"><div class="notification-icon-wrapper"><span class="notification-icon"></span></div><p id="notificationText"></p></div></div>
    
    <script src="assets/js/main.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            let isDeliveryAddressConfirmed = false;
            let isPickupAddressConfirmed = false;
            const initialCoords = [19.4326, -99.1332];

            function setupMap(mapId, inputId) {
                const map = L.map(mapId).setView(initialCoords, 13);
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
                const marker = L.marker(initialCoords, { draggable: true }).addTo(map);

                async function updateAddressFromCoords(lat, lng) {
                    const addressInput = document.getElementById(inputId);
                    addressInput.value = "Buscando...";
                    const url = `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}`;
                    try {
                        const response = await fetch(url);
                        const data = await response.json();
                        if (data && data.display_name) {
                            addressInput.value = data.display_name;
                        }
                    } catch (error) {
                        addressInput.value = "Error al buscar direcci√≥n.";
                    }
                }
                
                marker.on('dragend', (e) => updateAddressFromCoords(e.target.getLatLng().lat, e.target.getLatLng().lng));
                
                // Carga inicial de la direcci√≥n
                updateAddressFromCoords(initialCoords[0], initialCoords[1]);

                // Correcci√≥n para que el mapa se vea
                setTimeout(() => map.invalidateSize(), 400);
            }

            setupMap('deliveryMap', 'deliveryAddress');
            setupMap('pickupMap', 'pickupAddress');

            document.getElementById('deliveryAddressForm').addEventListener('submit', (e) => {
                e.preventDefault();
                isDeliveryAddressConfirmed = true;
                showNotification('Direcci√≥n de entrega confirmada.', 'success');
            });

            document.getElementById('pickupAddressForm').addEventListener('submit', (e) => {
                e.preventDefault();
                isPickupAddressConfirmed = true;
                showNotification('Direcci√≥n de recolecci√≥n confirmada.', 'success');
            });

            document.getElementById('finalizeOrderBtn').addEventListener('click', () => {
                if (!isDeliveryAddressConfirmed || !isPickupAddressConfirmed) {
                    showNotification('Por favor, confirma ambas direcciones.', 'error');
                    return;
                }
                window.location.href = 'pago.html';
            });
        });
    </script>
</body>
</html>
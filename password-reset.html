<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recuperar Contraseña - GreenHaul</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <link rel="stylesheet" href="assets/css/styles.css">
    <style>
        body {
            background: #f1f5f9;
        }
        .recover-container {
            max-width: 430px;
            margin: 90px auto;
            background: #fff;
            border-radius: 14px;
            box-shadow: 0 4px 22px rgba(74,144,226,0.09);
            border: 1px solid #e0e0e0;
            padding: 36px 30px 28px 30px;
        }
        .recover-container h2 {
            margin-bottom: 18px;
            color: #4ab3c1;
        }
        .recover-container .form-group {
            margin-bottom: 22px;
        }
        .recover-container .form-group label {
            font-weight: 600;
            margin-bottom: 7px;
            display: block;
        }
        .recover-container .form-control {
            width: 100%;
            padding: 11px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
        }
        .recover-container .btn-primary {
            width: 100%;
            padding: 12px 0;
        }
        .recover-container .result-message {
            margin-top: 18px;
            font-size: 1.05rem;
            min-height: 22px;
        }
        .recover-container .result-message.success {
            color: #008060;
        }
        .recover-container .result-message.error {
            color: #e74c3c;
        }
        .back-link {
            display: inline-block;
            margin-top: 25px;
            color: #4ab3c1;
            text-decoration: underline;
            font-size: 1rem;
        }
    </style>
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="container navbar-content">
                <a href="index.html" class="logo">
                    <img src="assets/img/Greenhaul-fl.svg" alt="Logo de GreenHaul" style="height: 49px;">
                </a>
            </div>
        </nav>
    </header>

    <main>
        <div class="recover-container">
            <h2>Recuperar Contraseña</h2>
            <form id="recoverForm" autocomplete="off">
                <div class="form-group">
                    <label for="email">Correo electrónico</label>
                    <input type="email" id="email" class="form-control" required placeholder="ejemplo@email.com">
                </div>
                <div class="form-group">
                    <label for="phone">Número de teléfono asociado</label>
                    <input type="tel" id="phone" class="form-control" required placeholder="Ej. 5512345678">
                </div>
                <button type="submit" class="btn btn-primary">Enviar contraseña temporal</button>
            </form>
            <div id="resultMessage" class="result-message"></div>
            <a href="login.html" class="back-link"><i class="fas fa-arrow-left"></i> Volver a Iniciar Sesión</a>
        </div>
    </main>

    <footer class="footer">
        <div class="container footer-content">
            <div class="footer-info">
                <h3>GreenHaul</h3>
                <p>Mudanzas sostenibles, sin complicaciones.</p>
            </div>
            <div class="footer-links">
                <h3>Enlaces Rápidos</h3>
                <ul>
                    <li><a href="index.html">Inicio</a></li>
                    <li><a href="productos.html">Productos</a></li>
                    <li><a href="servicios.html">Servicios</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            &copy; <span id="current-year"></span> GreenHaul. Todos los derechos reservados.
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Footer year
            document.getElementById('current-year').textContent = new Date().getFullYear();

            const recoverForm = document.getElementById('recoverForm');
            const resultMessage = document.getElementById('resultMessage');

            recoverForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                resultMessage.textContent = '';
                resultMessage.className = 'result-message';

                const email = document.getElementById('email').value.trim();
                const phone = document.getElementById('phone').value.trim();

                if (!email || !phone) {
                    resultMessage.textContent = 'Por favor, ingresa tu correo y tu número telefónico.';
                    resultMessage.classList.add('error');
                    return;
                }

                // Llamada a backend
                try {
                    const backendUrl = 'https://greenhaul-backend-production.up.railway.app';
                    const response = await fetch(`${backendUrl}/api/recover-password`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ email, phone })
                    });
                    const result = await response.json();
                    if (response.ok) {
                        resultMessage.textContent = result.message || 'Se ha enviado una contraseña temporal al correo indicado.';
                        resultMessage.classList.add('success');
                    } else {
                        resultMessage.textContent = result.message || 'No se pudo enviar la contraseña temporal.';
                        resultMessage.classList.add('error');
                    }
                } catch (err) {
                    resultMessage.textContent = 'Error al conectar con el servidor.';
                    resultMessage.classList.add('error');
                }
            });
        });
    </script>
</body>
</html>